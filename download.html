<!doctype html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="assets/images/favicon.ico">
  <link rel="stylesheet" href="assets/bootstrap/dist/css/bootstrap.min.css">
  <script src="assets/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="style.css">
  <meta name="theme-color" content="#6610f2" />
  <title>Download - Love Choice</title>
</head>

<body>
  <nav id="navbar"></nav>
  <script>
    // تحميل النافبار من ملف خارجي
    fetch('assets/modules/nav.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('navbar').innerHTML = data;

        // هنا نحدد العنصر اللي هياخد الـ class
        let currentPage = "download"; // غيرها حسب الصفحة
        let link = document.querySelector(`[data-page="${currentPage}"]`);
        if (link) {
          link.classList.add("active");
        }
      });
  </script>
  <main>
    <fieldset>
      <legend>عدد تحميلات اللعبة</legend>
      <div id="status" class="muted text">جارٍ جلب البيانات...</div>
      <div id="results" class="text"></div>
      <br>
    </fieldset>
    <fieldset>
      <legend>حجم اللعبة</legend>
      <div class="text" style="font-family: 'TurkFont'; text-align: center;">
        <p>حجم اللعبة هو 20 ميجابايت.</p>
      </div>
    </fieldset>
    <fieldset>
      <legend>تحميل اللعبة</legend>
      <p style="font-family: 'TurkFont';">يمكنك تحميل اللعبة من خلال الضغط على زر التحميل أدناه. بعد التحميل، قم بالنزول
        الى جدول التنزيلات واختار النسخة المتوفرة على جهازك.</p>
      <a href="https://github.com/MazenTurk201/Love-Choice/releases/latest" class="download_btn"
        target="_blank">تحميل</a>
      <br>
    </fieldset>
    <fieldset>
      <legend>صور من اللعبة</legend>
      <!-- <div class="imgslider">
        <img src="assets/images/s1.jpg" alt="Screenshot 1" class="img-fluid screenshotimg">
        <img src="assets/images/s2.jpg" alt="Screenshot 2" class="img-fluid screenshotimg">
        <img src="assets/images/s3.jpg" alt="Screenshot 3" class="img-fluid screenshotimg">
        <img src="assets/images/s4.jpg" alt="Screenshot 4" class="img-fluid screenshotimg">
        <img src="assets/images/s5.jpg" alt="Screenshot 5" class="img-fluid screenshotimg">
      </div> -->
      <!-- Slideshow container -->
      <div class="slideshow-container">

        <!-- Full-width images with number and caption text -->
        <div class="mySlides fade">
          <div class="numbertext">1 / 6</div>
          <img class="screenshotimg" src="assets/images/s1.jpg">
        </div>

        <div class="mySlides fade">
          <div class="numbertext">2 / 6</div>
          <img class="screenshotimg" src="assets/images/s4.jpg">
        </div>

        <div class="mySlides fade">
          <div class="numbertext">3 / 6</div>
          <img class="screenshotimg" src="assets/images/s5.jpg">
        </div>
        <div class="mySlides fade">
          <div class="numbertext">4 / 6</div>
          <img class="screenshotimg" src="assets/images/s2.jpg">
        </div>
        <div class="mySlides fade">
          <div class="numbertext">5 / 6</div>
          <img class="screenshotimg" src="assets/images/s6.jpg">
        </div>
        <div class="mySlides fade">
          <div class="numbertext">6 / 6</div>
          <img class="screenshotimg" src="assets/images/s3.jpg">
        </div>
        <br>
        <script>
          let slideIndex = 0;
          showSlides();

          function showSlides() {
            let i;
            let slides = document.getElementsByClassName("mySlides");
            for (i = 0; i < slides.length; i++) {
              slides[i].style.display = "none";
            }
            slideIndex++;
            if (slideIndex > slides.length) { slideIndex = 1 }
            slides[slideIndex - 1].style.display = "block";
            setTimeout(showSlides, 2000); // Change image every 2 seconds
          }
        </script>
    </fieldset>

    <button id="backToTop">⬆</button>
    <script>
      const backToTop = document.getElementById("backToTop");

      window.addEventListener("scroll", () => {
        if (window.scrollY > 200) { // يظهر بعد النزول 200px
          backToTop.classList.add("show");
        } else {
          backToTop.classList.remove("show");
        }
      });

      backToTop.addEventListener("click", () => {
        window.scrollTo({
          top: 0,
          behavior: "smooth"
        });
      });
    </script>
  </main>
  <footer id="footer"></footer>
  <script>
    // تحميل النافبار من ملف خارجي
    fetch('assets/modules/footer.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('footer').innerHTML = data;
      });
  </script>
  <script>
    async function fetchReleases() {
      const owner = "MazenTurk201";
      // const repo = "Easy-Command";
      // const repo = "Easy-Commnd";
      const repo = "Love-Choice";
      const url = `https://api.github.com/repos/${owner}/${repo}/releases?per_page=100`;

      const res = await fetch(url);
      if (!res.ok) {
        document.getElementById('status').textContent = `عطل فني : ${res.status} ${res.statusText}`;
        return;
      }

      const releases = await res.json();
      renderReleases(releases);
    }

    function renderReleases(releases) {
      const status = document.getElementById('status');
      const container = document.getElementById('results');

      if (!Array.isArray(releases) || releases.length === 0) {
        status.textContent = "لا توجد إصدارات متاحة الآن.";
        return;
      }

      status.textContent = `تم العثور على ${releases.length} إصدار.`;

      let html = `<table><thead><tr><th style="text-align: center;">النسخة</th><th style="text-align: center;">التاريخ</th><th style="text-align: center;">إجمالي التحميلات</th></tr></thead><tbody>`;
      releases.forEach(rel => {
        const total = (rel.assets || []).reduce((sum, a) => sum + (a.download_count || 0), 0);
        html += `<tr>
          <td>
            <strong class="text">${rel.name || rel.tag_name}</strong><br/>
            <small class="muted text" style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif">${rel.tag_name}</small><br/>
            ${(rel.assets || []).map(a => `${a.name}: ${a.download_count}`).join("<br/>") || "<span class='muted text'>لا توجد ملفات</span>"}
          </td>
          <td class="text" dir="ltr" style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif">${new Date(rel.published_at).toLocaleString()}</td>
          <td class="text total">${total}</td>
        </tr>`;
      });
      html += "</tbody></table>";

      container.innerHTML = html;
    }

    fetchReleases();
  </script>
</body>

</html>